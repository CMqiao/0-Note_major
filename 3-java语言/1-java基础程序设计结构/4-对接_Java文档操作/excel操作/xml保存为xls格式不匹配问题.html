解决格式与文件扩展名不一致的两种方法
发布于 2013-04-10 | 点击数：9

　　用2007或2010打开.xls格式的excel文件，有时会出现下面这样的提示：您尝试打开的文件**.xls的格式与文件扩展名指定的格式不一致。即格式与文件扩展名不一致。单击“是”，打开后的文件出现乱码问题。
格式与文件扩展名
　　出现上面的格式与文件扩展名指定的格式不一致，通常是开发的系统需要将DataGrdiView的数据导出Excel，首先用的是借助 microsoft.Office.Interop.Excel 来做，这种方法生成的Excel根本不是Excel，只不过扩展名是xls而已，所以打开的时候就会提示格式与文件扩展名不一致。
　　格式与文件扩展名不一致的问题，尝试下面方法解决：

方法一:格式与文件扩展名不一致方法一：使用注册表
　　单击开始-> 运行 -> 输入regedit -> 确定，打开注册表编辑器，找到注册表子项HKEY_CURRENT_USER/Software/Microsoft/Office/12.0/Excel/Security
　　在右侧空白处点击鼠标右键，选择“新建 -> DWORD值(D)”，输入"ExtensionHardening"点击确定。用鼠标右键点击ExtensionHardening，然后单击“修改（M）”，在数值数据中填写"0"即可确定。关闭注册表编辑器，再次打开xls文件查看是否已经没有了格式与文件扩展名不一致的提示。

方法二:格式与文件扩展名不一致方法二：使用现有版本保存。
　　先用Excel2007或者2010打开xls的文件，将其另存为“EXCEL工作薄”。再用Excel2007打开xlsx的文件，将其另存为“Excel 97-2003 工作簿”。

方法三：出现警告时继续点击打开文件，然后文件另存为.xls结尾的文件，这时文件就正常了。